Assignment Instructions 
Using Kibana to analyze logs taken during the Red Team attack, use the data to develop ideas for new alerts that can improve your monitoring. 

After creating your dashboard and becoming familiar with the search syntax, use these tools to answer the questions below: 

Identify the traffic between your machine and the web machine: 
When did the interaction occur? 
**May 1, 2021 from 6pm to 9pm**

What responses did the victim send back? 
404, 200, 400 

What data is concerning from the Blue Team perspective? 
All the request queries. 

Find the request for the hidden directory. 
 
 

In your attack, you found a secret folder. Let's look at that interaction between these two machines. 

How many requests were made to this directory? At what time and from which IP address(es)? 
9919 requests.  May 2 at 2pm from  

Which files were requested? What information did they contain? 
2 files, the passwd.dav and shell.php. They contained hashâ€™s, encrypted passwords. 

What kind of alarm would you set to detect this behavior in the future? 
Set an alarm for   

Identify at least one way to harden the vulnerable machine that would mitigate this attack. 
Remove the folder from public view. Take it off the server.  
 
 

Identify the brute force attack. (We have hydra, we have 10k hits, & password protected secret folder) 
 
 

After identifying the hidden directory, you used Hydra to brute-force the target server. Answer the following questions: 

Can you identify packets specifically from Hydra? 
 
 

How many requests were made in the brute-force attack? 
Over 10,000 hits. 

How many requests had the attacker made before discovering the correct password in this one? 
2 

What kind of alarm would you set to detect this behavior in the future and at what threshold(s)? 
 
 

Identify at least one way to harden the vulnerable machine that would mitigate this attack. 
Block Hydra, increase lockout attempts,  
 
 
 
 

Find the WebDav connection. 
 
 

Use your dashboard to answer the following questions: 

How many requests were made to this directory? 
38 

Which file(s) were requested? 
 
 

What kind of alarm would you set to detect such access in the future? 
 
 

Identify at least one way to harden the vulnerable machine that would mitigate this attack. 
 
 
 

Identify the reverse shell and meterpreter traffic. 
 
 

To finish off the attack, you uploaded a PHP reverse shell and started a meterpreter shell session. Answer the following questions: 

Can you identify traffic from the meterpreter session? 
Yes, from port 4444 

What kinds of alarms would you set to detect this behavior in the future? 
Create a log for traffic on 4444. Anything being uploaded as a php, block it.  

Identify at least one way to harden the vulnerable machine that would mitigate this attack. 
We added a file. 
